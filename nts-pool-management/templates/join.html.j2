{% extends "layout.html.j2" %}

{% block header %}<h1>Using the NTS pool for time synchronization</h1>{% endblock %}

{% block content %}
  <section class="contained">
    <p>When running a compatible NTS server, you can join the pool. {% if !(app.user|is_logged_in) %} To do so, you will have to <a href="/login">log in</a> or <a href="/register">register</a> for an account. {% endif %} Your server must have a proper domain name, and use a generally accepted TLS certificate.</p>

    <p>New servers can be added on the <a href="/management/time-sources">Time sources</a> page. For this, use the add a time source form at the top of the page, providing the domain name at which your NTS server is reachable.</p>

    <p>After registering your NTS server, you will receive an authentication token. This token is used by the pool to authenticate itself to your time server. Depending on the software you use, you must configure it to accept this token. To configure this, refer to your NTS server's documentation, linked to below</p>

    <p>Your server will now be shown on your <a href="/management/time-sources">Time sources</a> page after logging in. If it is functioning correctly, it's score will start increasing after about 15 minutes. If not, please check the domain name is correct, the server is reachable on that domain name, and that the pool authentication token has been correctly configured.</p>

    <h2>Supported server software</h2>

    <h3><a href="https://docs.ntpd-rs.pendulum-project.org/guide/nts-pool/">ntpd-rs version 1.7.0-alpha.20251003 or newer</a></h3>

    <p>To join the pool, setup the ntpd-rs as an NTS server, for example by following <a href="https://docs.ntpd-rs.pendulum-project.org/guide/nts/">the NTS guide in the ntpd-rs documentation</a>. Then register the server for the pool, and add the token to the <code>[[nts-ke-server]]</code> section as follows:</p>
    <code-block>
    accepted-pool-authentication-tokens = ["&lt;YOUR TOKEN HERE&gt;"]
    </code-block>

    <p>After doing this, you should see the score of your server start to increase over time.</p>

    <h3><a href="https://github.com/pendulum-project/chrony/releases">Modified versions of chrony</a></h3>

    <p>Please note that when using chrony, a <a href="https://github.com/pendulum-project/chrony/releases">custom version of chrony</a> is currently needed for the pool. To join the pool, setup chrony to be an NTS server. Once your chrony server works as a regular NTS server, you are ready to register it for the pool. Having got the authentication token, create a file containing the token on a single line ended by a newline, and give it rights so that only chrony and root can read it. Then add the following to your chrony configuration:</p>
    <code-block>
    ntsauthtokenfile /path/to/file/with/your/token
    </code-block>

    <p>After doing this, you should see the score of your server start to increase over time.</p>

    <h3><a href="https://github.com/pendulum-project/pool-ntpsec/releases">Modified versions of NTPsec</a></h3>

    <p>Please note that when using NTPsec, a <a href="https://github.com/pendulum-project/pool-ntpsec/releases">custom version of NTPsec</a> is currently needed for the pool. To join the pool, setup NTPsec to be an NTS server. Once your NTPsec server works as a regular NTS server, you are ready to register it for the pool. Having got the authentication token, create a file containing the token on a single line ended by a newline, and give it rights so that only NTPsec and root can read it. Then add the following to your NTPsec configuration:</p>
    <code-block>
    nts poolauth /path/to/file/with/your/token
    </code-block>
  </section>
{% endblock %}
